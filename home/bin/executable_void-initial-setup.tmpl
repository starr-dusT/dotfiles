#!/usr/bin/env bash

echo -e "Starting initial setup..."

# Install ansible python dependencies
sudo xpbs-install -Syu -y
sudo xbps-install python3 python3-pip ansible -y
sudo pip install pexpect github3.py -y

# Install ansible extensions
ansible-galaxy install -r {{ .chezmoi.workingTree }}/provision/requirements.yml

# Goto playbook and run it
cd {{ .chezmoi.workingTree }}/provision
ansible-playbook setup.yml -i hosts --ask-become-pass

# Return to where you were
cd -

echo "I'd suggest rebooting"
